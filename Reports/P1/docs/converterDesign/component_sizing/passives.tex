The power circuit includes three main passive components which are the inductor, the input capacitor and the output capacitor. The coil will influence the maximum current ripple that will flow through it, while the capacitors will set the voltage ripple at the input and at the output of the MIC. The worst case scenario was considered for calculating the minimum inductance and capacitance of the components.
\label{sec:componentsizing}
Therefore, in order to calculate these values, current and voltage ripples have been set. For the current through the coil, a 10\% maximum ripple has been chosen. The output voltage will  have a maximum of 0.5\% ripple. However, the input capacitor makes the PV module's voltage flat. Therefore, the ripple found at $V_{in}$ directly influences the maximum power extracted from the PV since it produces a deviation from the MPP. Giving this, a low input voltage ripple of 0.1\% has been selected. The ripple, however, also depends on the working frequency of the switches. In the case of this converter, the switching frequency has been set to 50 kHz. 

Since the current ripple on the inductor is a percentage of the absolute current, the worst case scenario for calculating it occurs when the current is lowest. A lower working conditions limit is then selected at which the values will be calculated, this is the solar panel working at $400 W/m^2$ and at a temperature of $25 ÂºC$. Under this conditions, the MPP voltage obtained is $V_{MPP} = 36.19 V$ and the MPP current is $I_{MPP} = 3.23A$. If the $I_{MPP}$ is lower the ripple will not meet the 10\% constraint.

On the other hand, the capacitors' voltage will have a higher ripple when the current is maximum, this means that the system is working at the maximum irradiance ($1000 W/m^2$). The PV will then output a voltage of $V_{MPP} = 36.9 V$ and a current of $I_{MPP} = 8.14 A$.

The minimum current flow through the coil is achieved when the boost mode is active. For this, the inductance is calculated for the maximum output voltage, which is when 4 MICs are connected in series. According to the equations, stated in the equation 2.43, section 2.3 of the book \textit{"Fundamentals of Power Electronics"} \cite{Erickson}, the inductance has been sized as seen in equation \ref{L_calculation}.

\begin{equation} \label{L_calculation}
L = \frac{V_{in} \cdot D}{\Delta I_{L} \cdot f} = \frac{V_{in} \cdot (1 -  \frac{V_{in}}{V_{out}})}{\Delta I_{L} \cdot f} =  \frac{36.19 V \cdot (1-\frac{36.19V}{90V})}{0.1 \cdot 3.23 A \cdot 50 kHz} = 1.3 \ mH
\end{equation}

On the other hand, the input and output voltages used for $C_{in}$ are obtained when buck mode is working with 15 MICs connected in series. This is a total output voltage of $24 V$.
The capacitance required is then found as stated in equation \ref{Cin_calculation} (Equation 2.57, section 2.4 of \textit{"Fundamentals of Power Electronics"} \cite{Erickson}).

\begin{equation} \label{Cin_calculation}
C_{in} = \frac{I_{in} \cdot (1 - D)}{\Delta V_{in} \cdot f} = \frac{8.14 A \cdot ( 1 - \frac{24 V}{36.9 V})}{0.001 \cdot 36.9 V \cdot 50 kHz} = 1.54 mF
\end{equation}

Finally, $C_{out}$ is calculated in the worst case scenario of boost mode. The output voltage is then $55V$. The values are calculated with the method found in equation 2.47, section 2.3 of \textit{"Fundamentals of Power Electronics"} \cite{Erickson}. The procedure can be seen in equation \ref{Cout_calculation}.
\begin{equation} \label{Cout_calculation}
C_{out} = \frac{I_{out} \cdot D}{\Delta V_{out} \cdot f} = \frac{5.45 A \cdot ( 1 - \frac{36.9 V}{55 V})}{0.005 \cdot 55 V \cdot 50 kHz} = 130 \mu F
\end{equation}  
