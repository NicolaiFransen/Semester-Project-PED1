The power circuit includes three main passive components which are the inductor, the input capacitor ($C_{in}$) and the output capacitor ($C_{out}$). According to these values, the coil will influence the maximum current ripple that there will flow through it while the capacitors will set the voltage ripple at the input and at the output of the MIC. In order to calculate the minimal inductance and capacitance that components need to have, the worst case scenario was considered.

Therefore, in order to calculate these values the ripples have been set. For the current through the coil, a 10\% maximum ripple has been chosen. The output capacitor will  have a maximum of 0.5\% voltage ripple. However, the input capacitor makes the PV-module output voltage flat, therefore the ripple found at $C_{in}$ directly influences the maximum power extracted from the PV since it produces a deviation from the MPP. Giving this, a low input voltage ripple of 0.1\% has been selected.

The ripple, however, also depends on the working frequency of the switches. In the case of this converter, such frequency has been set to 50kHz. 

Since the coil ripple is a percentage of the absolute current, the worst case scenario for calculating it occurs when the current is lowest. A lower limit is then implemented at which the values will be calculated, this is the solar panel working at $400 W/m^3$ and at a temperature of $25 ºC$.

Under this conditions, the MPP voltage obtained is $V_{mpp} = 36.25 V$ and the MPP current is $I_{mpp} = 3.23A$.

On the other hand, the capacitors will have a higher ripple when the current is maximum, this means that the system is working the maximum irradiance ($1000 W/ºC$). 

The PV will then output a voltage of $V_{mpp} = 36.9 V$ and a current of $I_{mpp} = 8.14 A$.

The minimum current flow through the coil is achieved when the boost mode is active. For this, the inductance is calculated for the maximum output voltage, which is when 4 MICs are connected in series. According to the equations stated in the section 2.2 of the book Fundamentals of Power Electronics \cite{Erickson}, the inductance has been sized as seen in equation \ref{L_calculation}.

\begin{equation} \label{L_calculation}
L = \frac{(V_{out} - V_{in}) \cdot D}{\Delta I_{L} \cdot f} = \frac{(90 V - 36.25 V) \cdot 0.4}{0.1 \cdot 3.23 A \cdot 50 kHz} = 1.3 mH
\end{equation}

On the other hand, the voltage used for $C_{in}$ is obtained when buck mode is working with 15 MICs connected in series. This is a total output voltage of $24 V$.
The capacitance required is then found as stated in equation \ref{Cin_calculation} (Section 2.4 of Fundamentals of Power Electronics \cite{Erickson}).

\begin{equation} \label{Cin_calculation}
C_{in} = \frac{I_{in} \cdot (1 - D)}{\Delta V_{in} \cdot f} = \frac{8.14 A \cdot ( 1 - \frac{24 V}{36.9 V})}{0.001 \cdot 36.9 V \cdot 50 kHz} = 1.54 mF
\end{equation}

Finally, $C_{out}$ is calculated in the worst case scenario of boost mode. The output voltage is then 90V. The values are calculated with the method found in section 2.3 of Fundamentals of Power Electronics \cite{Erickson}. The procedure can be seen in equation \ref{Cout_calculation}.

\begin{equation} \label{Cout_calculation}
C_{out} = \frac{I_{out} \cdot D}{\Delta V_{out} \cdot f} = \frac{3.34 A \cdot ( 1 - \frac{36.9 V}{90 V})}{0.005 \cdot 90 V \cdot 50 kHz} = 88 \mu F
\end{equation}
   
